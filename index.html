<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Decantcias | LABORATORIO</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        /* DISE√ëO PREMIUM INTEGRADO */
        :root { --dorado: #8a6d3b; --dorado-claro: #bfa16a; --fondo: #faf7f2; }
        body { font-family: 'Poppins', sans-serif; background: var(--fondo); margin: 0; padding-bottom: 120px; color: #333; }
        .top-banner { width: 100%; background: #fff; text-align: center; border-bottom: 1px solid #eee; }
        .top-banner img { max-width: 100%; height: auto; max-height: 200px; }
        .container { max-width: 1100px; margin: auto; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 25px; }
        .card { background: #fff; padding: 15px; border-radius: 18px; text-align: center; box-shadow: 0 10px 20px rgba(0,0,0,.05); cursor: pointer; transition: .25s; border: 1px solid #f0f0f0; }
        .card img { width: 100%; height: 240px; object-fit: contain; border-radius: 12px; }
        .price { font-size: 1.2rem; color: var(--dorado-claro); font-weight: bold; margin-top: 10px; }
        
        /* MODALES */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,.7); backdrop-filter: blur(6px); z-index: 9999; }
        .modal-content { background: #fff; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 420px; border-radius: 20px; padding: 20px; max-height: 85vh; overflow-y: auto; text-align: center; }
        .close-btn { position: absolute; top: 10px; right: 10px; border: none; background: #eee; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; }
        .btn-main { width: 100%; padding: 15px; border: none; border-radius: 40px; background: var(--dorado); color: #fff; font-weight: 600; cursor: pointer; margin-top: 15px; }
        
        /* BARRA CARRITO */
        .cart-bar { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 420px; background: var(--dorado); color: #fff; padding: 12px 20px; border-radius: 40px; display: flex; justify-content: space-between; align-items: center; z-index: 999; }
        
        /* ETIQUETA DE PRUEBA */
        .debug-tag { background: red; color: white; position: fixed; top: 0; width: 100%; text-align: center; font-size: 12px; z-index: 10000; font-weight: bold; }
    </style>
</head>
<body>

<div class="debug-tag">EST√ÅS EN LA WEB DE PRUEBAS (CONECTADA AL EXCEL)</div>

<div class="top-banner">
    <img src="img/DECANTCIAS_BANNER.png" alt="Banner" onerror="this.src='https://via.placeholder.com/800x200?text=Decantcias+Banner'">
</div>

<div class="container">
    <div class="grid" id="main-grid"></div>
</div>

<div id="productModal" class="modal">
    <div class="modal-content">
        <button class="close-btn" onclick="closeModals()">‚úï</button>
        <img id="modal-img" src="" style="width:100%; height:240px; object-fit:contain;">
        <h2 id="modal-title" style="font-family: 'Playfair Display', serif;"></h2>
        <div id="modal-price" class="price"></div>
        <p id="modal-desc" style="color: #666; font-size: 0.9rem; text-align: left; margin: 15px 0; white-space: pre-line;"></p>
        <button onclick="addToCart()" class="btn-main">A√±adir al Carrito</button>
    </div>
</div>

<div class="cart-bar" onclick="alert('Carrito en desarrollo para pruebas')">
    <div>üõí <strong id="cart-count">0</strong> productos</div>
    <strong id="cart-total">$0</strong>
</div>

<script>
// LINK A TU HOJA "WEB"
const sheetURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQsmuT-sX_hT2VXW9_7AbpfRkS1plqwYKV3zrzUVDUf44aEhUZU7btUwp_QUwDoNbv3VANut3ZntOzK/pub?gid=751988153&single=true&output=csv';

async function getProducts() {
    try {
        const res = await fetch(sheetURL);
        const data = await res.text();
        const rows = data.split('\n').slice(1);
        
        const products = rows.map((row, index) => {
            const cols = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
            if (cols.length < 4) return null;
            return {
                id: index,
                name: `${cols[0]?.replace(/"/g, "").trim()} ${cols[1]?.replace(/"/g, "").trim()}`,
                price: parseInt(cols[2]?.replace(/[^0-9]/g, "")) || 0,
                desc: cols[7]?.replace(/"/g, "").trim() || "Fragancia premium.",
                img: cols[8]?.trim() || 'https://via.placeholder.com/300?text=Decantcias'
            };
        }).filter(p => p !== null);

        const grid = document.getElementById("main-grid");
        grid.innerHTML = "";
        products.forEach(p => {
            const c = document.createElement("div");
            c.className = "card";
            c.onclick = () => {
                document.getElementById("modal-img").src = p.img;
                document.getElementById("modal-title").innerText = p.name;
                document.getElementById("modal-price").innerText = "$" + p.price.toLocaleString();
                document.getElementById("modal-desc").innerText = p.desc;
                document.getElementById("productModal").style.display = "block";
            };
            c.innerHTML = `<img src="${p.img}"><h3>${p.name}</h3><div class="price">$${p.price.toLocaleString()}</div>`;
            grid.appendChild(c);
        });
    } catch (e) { console.error(e); }
}

function closeModals() { document.getElementById("productModal").style.display = "none"; }
window.onclick = e => { if (e.target.className === "modal") closeModals(); };

getProducts();
</script>
</body>
</html>
